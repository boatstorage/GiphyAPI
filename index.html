<!DOCTYPE html>
<html>
<head>
	<title>celebrity gifs</title>
</head>
<body>

	<div class="container">
		<h1>Celebrity gifs!</h1>

		
		<div id ="buttons-view"></div>

		<form id="gif-form">
      <label for="gif-input">Add a celebrity gif</label>
      <input type="text" id="gif-input"><br>

      
      <input id="add-gif" type="submit" value="Add a celebrity gif">
    </form>
	<div id="gif-view"></div>
	</div>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript">

	var topics = ["jennifer lawrence", "eddie murphy" ];


	function getGif(){

	$("#gif-view").empty();
       
	var celebrity = $(this).attr("data-name");

	var queryURL = "http://api.giphy.com/v1/gifs/search?q=" + celebrity + "&api_key=dc6zaTOxFJmzC&limit=10";




	$.ajax({
		url: queryURL,
		method: "GET"
	}).done(function(response) {

		console.log(response);

		var results = response.data;

		for (var i = 0; i < results.length; i++) {

		var imagesDiv = $("<div class='images'>");
		
		var imageUrl = results[i].images.fixed_height.url;

		var imageUrlStill = results[i].images.fixed_height_still.url;


		var celebImg = $("<img>").attr("src", imageUrl).attr("data-still", imageUrlStill).attr("data-animate", imageUrl).attr("data-state", "still").addClass("gif");

		var rating = $("<p>").text("Rating: " + results[i].rating);

		imagesDiv.append(celebImg);
		imagesDiv.append(rating);



		$("#gif-view").append(imagesDiv);

		$(".gif").on("click", function(event) {
		console.log(this)
		event.preventDefault();
		var state = $(this).attr("data-state");
		

		if (state === "still") {
			$(this).attr("src", $(this).attr("data-animate"));
			$(this).attr("data-state", "animate");
		} else {
			$(this).attr("src", $(this).attr("data-still"));
			$(this).attr("data-state", "still");

			
		}
	})
	}
		

	})

	}
	getGif();



	function makeButtons() {

		$("#buttons-view").empty();

		for (var i = 0; i < topics.length; i++) {
			var a = $("<buttons>");
			a.addClass("gifs");
			a.attr("data-name",topics[i]);
			a.text(topics[i]);

			$("#buttons-view").append(a);
		}
	}

	$("#add-gif").on("click", function(event){
		event.preventDefault();

		var gif = $("#gif-input").val().trim();

		topics.push(gif);

		makeButtons();
		
	});


	

	$(document).on("click", ".gifs", getGif);

	


	makeButtons();

	</script>


</body>
</html>

